---
title: "1. StreamTemp Plots"
author: "Leslie Jones"
date: "January 11, 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(tidyverse)
library(dplyr)
library(lubridate)
library(ggplot2)
library(knitr)
library(rmarkdown)
library(DT)
library(StreamThermal)
```

#Import Kenai Data which has been summarized to daily mean, max, and min. Months that were kept for analysis are May thru September. Plots suggest that may and September temperartures are on the ascending and descending limb of summer temperature regime. June, July, and August are likely more similar in nature. Should consider this when parameterizing model.
```{r results='hide'}
KenaiTemp <- read.csv(file="C:/KFHP/Data/STemp/Kenai/KenaiTemp.csv", header=TRUE, sep=",")
class(KenaiTemp$sampleDate)
KenaiTemp$sampleDate <- as.Date(KenaiTemp$sampleDate, format= "%Y-%m-%d")
class(KenaiTemp$sampleDate)
#View(KenaiTemp)
```
Show n by year and month.
```{r}
month_year <- count(KenaiTemp, year, month) %>% arrange(year)
datatable(month_year)
```
Number of sites by year and month.
```{r}
month_site <- count(KenaiTemp, siteID, year, month) %>% arrange(year, month)
datatable(month_site)
```

##Plot by site

```{r}
sites <- unique(KenaiTemp$siteID)
#View(sites)

KenaiTemp <- KenaiTemp %>% 
  mutate(mday = format(sampleDate, "%m-%d"))

for (i in sites) {
  print(ggplot(KenaiTemp %>% filter(siteID==i), aes(x=as.Date(mday, format = "%m-%d"), y=meanT)) + 
          geom_point() + 
          ggtitle(i) +
          labs(x="Date", y="Temperature (C)") + facet_wrap(~year))

 }

```
#Playing with the new StreamThermal package in R
```{r}
#sitedata2 <- subset(KenaiTemp, KenaiTemp$siteID=="KR_USGS" & year==2008)
#sitedata <- sitedata2[, c(2,3,9,8,7)]

#head(sitedata, 10)
#sitedata <- sitedata %>% rename (MeanT = meanT, MinT = minT, MaxT= maxT, Date = sampleDate) 
#View(sitedata)
#T_variability(sitedata, SeasonSu = c(6, 7, 8, 9))
```